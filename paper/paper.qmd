---
title: "Stream of Consciousness Literature: A 'Joyceless' Linguistic Landscape" 
subtitle: "Exploring Word Frequency, Sentiment Value and Mental Health Themes in the Works of Joyce, Woolf, Proust, Mansfield and Eliot from Project Gutenberg"
author: Quang Mai
thanks: "Code and data are available at: https://github.com/ponolite/stream-consciousness-language.git"
date: today
date-format: long
abstract: "This project focuses on understanding the language used by renowned stream of consciousness (SOC) authors James Joyce, Virginia Woolf, Marcel Proust, Katherine Mansfield and T.S Eliot. By conducting word frequency analysis and sentiment analysis on these authors' nine novels, we aim to uncover shared linguistic patterns and gain insights into the authors' mental states. Our analysis of the SOC genre shows that higher frequency words are mostly negative and carry sadness or fear-inclined connotations, with clear linguistic differences between female and male authors. With these trends uncovered, we attempt to offer insights into themes of self-identity, anxiety, disassociation and existential contemplation within Western society and its literary circle from late 19th to mid-20th century."
format: pdf
number-sections: true
bibliography: references.bib
toc: true
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(tidytext)
library(rmarkdown)
library(gutenbergr)
library(tm)
library(dplyr)
library(ggplot2)
library(scales)
library(knitr)
library(igraph)
library(widyr)
library(ggraph)
library(textdata)
library(arrow)
library(kableExtra)

portrait_clean <- read_parquet(here::here("data/analysis_data/portrait_clean.parquet"))
portrait_words <- read_parquet(here::here("data/analysis_data/portrait_words.parquet"))
swann_words <- read_parquet(here::here("data/analysis_data/swann_words.parquet"))
dalloway_words <- read_parquet(here::here("data/analysis_data/dalloway_words.parquet"))
bliss_words <- read_parquet(here::here("data/analysis_data/bliss_words.parquet"))
prufrock_words <- read_parquet(here::here("data/analysis_data/prufrock_words.parquet"))
combined_text <- read_parquet(here::here("data/analysis_data/combined_text.parquet"))
portrait <- read_parquet(here::here("data/raw_data/portrait.parquet"))
all_books <- read_parquet(here::here("data/raw_data/all_books.parquet"))
combined_books <- read_parquet(here::here("data/raw_data/combined_books.parquet"))

```

# Introduction

Stream of consciousness (SOC) is a narrative technique that aims to capture the continuous flow of thoughts, feelings, and sensations experienced by a character without conventional organization or punctuation [@resampling]. It mirrors the unpredictable and interconnected nature of human thought processes, often revealing the emotional well-being and psychological struggles of the character's mind in an intimate and unfiltered manner [@flow] [@pathology]. As such, this paper has mined the texts of a total of nine novels from the volunteer archive, Project Gutenberg, to examine the mental health themes of famous stream of consciousness authors, namely by Joyce, Woolf, Proust, Mansfield and Eliot, from the modernist era of literature, spanning from late 19th century to mid-20th century [@gutenberg]. 

By analyzing these textual datasets through word frequency and sentiment analysis, this paper seeks to pose and answer crucial questions: \textit{What are some important factors contributing to this relationship between mental health, disassociation and stream of consciousness? Moreover, how does this relationship vary differently across differnet demographics of authors, for instance, authors with different genders?} Understanding these dynamics is crucial in having an informed understanding of the West's late 19th to mid-20th century literature and even socio-political landscape, especially in regards to how authors and creative writers navigate and deal with then-taboo topics such as existential angst, mental health issues and anxiety

Thus, the estimand is the correlation between mental health-related words in SOC literature, their appearance frequency and sentiment value. This is considered in terms of nine SOC texts only, namely Joyce's \textit{A Portrait of the Artist as a Young Man and Chamber Music}; Woolf's \textit{Mrs Dalloway and Jacob's Room}; Proust's \textit{Swann Way}; Mansfield's \textit{Bliss and The Garden Party}; and Eliot's \textit{The Waste Land and The Love Song of J. Alfred Prufrock}. Through our analysis, we found that words that appear with high frequency are mostly negative in select SOC literature (-1.875 median out of 5 on the AFINN index). Sentiment-wise, analysis reveals that a predominant 27% to 37% of words in SOC texts are negative and sadness-inclined (NRC index), and over 60% of words in these texts are negative (Bing index). Abstract and temporal nouns like "time," "day," "life," and "moment" are the most frequent, respectively appearing 870, 597, 567, and 502 times in all texts combined. Gender-wise, male SOC authors are more likely to have negative words compared to female authors. These statistics correlate with SOC's non-linear nature, the genre's exploration of the unconscious mind (which often correlates to mental health themes), and its reflection of Western society in late 19th to mid-20th century.

To further understand the correlation between stream of consciousness texts and mental health themes, in [Introduction], the paper briefly discusses the nature of stream of consciousness literature, relevant authors and the works that we have chosen to analyze. Subsequently, in [Data] and [Results], we talk about the nature of the data obtained and analyze the results garnered from the data with suitable tables and charts. Next, [Discussion] provides further insights and future areas of study. Finally, [Conclusion] summarizes our main findings. 

# Data {#sec-data}

The SOC texts used for analysis were sourced from Project Gutenberg under the library `gutenbergr` [@rGuten] [@gutenberg]. Data was generated, extracted and cleaned using the open-source statistical programming language R [@r], leveraging functions from `tidyverse` [@rTidyverse], `tidytext` [@rTidytext], `rmarkdown` [@rMark], `dplyr` [@rDplyr], `ggplot2` [@rGgplot2], `scales` [@rScales], `here` [@rHere], `igraph` [@rIgraph], `widyr` [@rWidy], `ggraph` [@rGg], `textdata` [@rTextdata], `tm` [@rTm], `kableExtra` [@kableExtra], `arrow` [@arrow], and `knitr` [@rKnitr]. More information on the dataset or the HTML textual data sourced from Project Gutenberg is available in the documented datasheet available within this folder, paper/datasheet_project_gutenberg.pdf, located within the paper's GitHub repository.

## Measurement

Two central variables in this paper are:

* **Word Frequency:** This variable captures the repetition percentage of a single word (unigram) or a pair of words combination (bigram) throughout a SOC novel text, providing us with a thematic understanding of SOC literature.
* **Sentiment Value:** This variable enables us to analyze how every word is usually perceived emotionally, whether it be a qualitative feeling or if it is conveyed through a numerical value.

Out of two variables used, the first one, 'Word Frequency' usually captured as `n/sum(n)` or `frequency` in datasets, is directly quantified through tokenizing the novel texts using the package `tidytext` and its function `unnest_tokens()` [@rTidytext]. To do this, we downloaded all nine SOC texts from @gutenberg, using functions such as `unnest_tokens()` from @rTidytext to mine the texts, or separating them into individual words. Finally, we used `count()` to quantify the word count (`n`), and later divide the each word's count over the total word count of each author to garner the word frequency percentages (`n/sum(n)`). 

The second variable used, 'Sentiment Value', is based on three English-based, general-purpose  "word-emotion and word-polarity association lexicons", sourced from Mohammad and Turney's expansive research along with efforts from Finn Årup Nielsen and Bing Liu and collaborators [@rTidytext] [@sentiment]. The three general-purpose lexicon that contributes to this paper's sentiment analysis are [@rTidytext]:

- 'AFINN' from Finn Årup Nielsen, which assigns each word a numerical value from '-5 to 5', judging its emotionality from negative to postive
- 'bing' from Bing Liu and collaborators, which assigns if a word is either 'positive' or negative'
- 'nrc' from Saif Mohammad and Peter Turney, which assigns a core emotional value to a word, such as 'fear', 'anger', 'sadness' or 'trust'

In terms of measuring 'Sentiment Value', all three general-purpose lexicons are compiled through crowd-sourcing and directly surveying the public on how each word is emotionally perceived. A survey sample of how the word 'startle' is compiled within the 'nrc' lexicon is presented below [@sentiment]:

(@) Which word is closest in meaning (most related) to startle?
- automobile
- shake
- honesty
- entertain

(@) How positive (good, praising) is the word startle?:
- startle is not positive
- startle is weakly positive
- startle is moderately positive
- startle is strongly positive

(@) How negative (bad, criticizing) is the word startle?
- startle is not negative
- startle is weakly negative
- startle is moderately negative
- startle is strongly negative

After the survey results are garnered, researchers average the answers to sort each surveyed word into pre-defined categories, specifically '-5 to 5' for 'AFINN', 'postive' or 'negative' for 'bing', and 'anger' or 'fear' for 'nrc'. With the continuous work of compiling these lexicons spanning years and decades [@sentiment] comes these functions: `get_sentiments("bing")` and `get_sentiments("nrc")` and `get_sentiments("afinn")`. We can then use `inner_join` with these lexicons to categorize our existing datasets of SOC texts into pre-defined sentiment value. Systematic and data-driven, these measurement methods ensure that all lexicons faithfully reflects each word's emotionality.

However, this paper does recognize how reductive this quantification of language can be. When it comes to understand such social and human artifacts as language, much depends on their context. As such, this paper will further discuss these weaknesses of the datasets under [Discussion].

## Source Data: Project Gutenberg

Founded in December 1, 1971 by Michael S. Hart, Project Gutenberg exclusively publishes literature in the public domain within the United States. Typically, submissions to Project Gutenberg are digitized editions of printed books, the majority of which were published over 95 years ago. To confirm public domain status, authors can use the copy.pglaf.org website [@gutenberg].

The archive relies heavily on volunteers for support and content selection, but it does not accept copyrighted or modern works, even with permission. To submit work, individuals must obtain copyright clearance, scan or capture book images, dedicate hours to proofreading and formatting, and ensure compliance with Project Gutenberg’s guidelines, including valid HTML and correct spelling. Common points of failures for submitted works include:

- Crop marks or other printer's marks should not be used on any files.
- The book description should be in compliance with the rules listed here.
- Missing Pages
- Title missing on the front cover
- Incorrect pagination
- Books with typographical errors, such as misspellings or poor grammar.

Most new Project Gutenberg eBooks are in HTML format, which is validated using the W3C’s online validator. Additionally, the archive prefers plain text versions whenever possible due to their universal accessibility, and long-term usability. PDF, Word, and other word processor formats are avoided as master formats due to the challenges involved in converting them to HTML and updating them [@gutenberg].

With these points being addressed and the impartial nature of the archive being publicly disclosed on its website, the source data seems to archive SOC literary texts with strict quality control and accuracy. However, there are potential spaces for biases such as selection bias where Project Gutenberg primarily hosts older works that have entered the public domain. Thus, archived works might gear towards certain genres, authors, or time periods, potentially limiting the diversity of the datasets for analysis, which will be further discussed below [@gutenberg].

### Data Cleaning and Word Tokenization

```{r}
#| echo: false
#| eval: true
#| label: tbl-joyce
#| tbl-cap: "Sample Table Containing Unprocessed Novel Text (James Joyce)"
#| warning: false

portrait |>
  rename("Book ID" = gutenberg_id,
         "Text" = text,
         "Book" = book,
         "Author" = author) |>
  head(3) |>
  kable(
    col.names = c("Book ID", "Text", "Book", "Author"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position"), 
                bootstrap_options = "striped", 
                full_width = FALSE)

```

To collect text data from five SOC authors using the `gutenbergr` package, we first downloaded the index of each author's works from the Project Gutenberg database. These authors include Joyce, Mansfield, Eliot, Woolf, and Proust [@rGuten] ([Appendix]'s @tbl-combined and @tbl-all).

Next, custom datasets containing each author's raw texts were created. This involved using the identification number of the nine desired literary works and the `gutenberg_download` function to retrieve the HTML texts. Subsequently, the data was saved into individual Parquet datasets, as demonstrated in @tbl-joyce.

\newpage

```{r}
#| echo: false
#| eval: true
#| label: tbl-joyce-token
#| tbl-cap: Sample Table of Tokenized Stream of Consciousness Text (James Joyce)
#| warning: false
#| message: false

portrait_clean |>
  rename("Book ID" = gutenberg_id,
         "Book" = book,
         "Author" = author,
         "Word" = word) |>
  tail(5) |>
  kable(
    col.names = c("Book ID", "Book", "Author", "Word"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position"), 
                bootstrap_options = "striped", 
                full_width = FALSE)


```

Next, in @tbl-joyce-token, to measure the word count of each literary text, we first tokenized or separated each text into individual chunks of words using `unnest_tokens()` [@rTidytext]. In addition, to account for stop words like, a, of, and, etc., the dataset `stop_words`and the function `anti_join` from @rTidytext were used to exclude all stop words from the self-generated datasets of SOC texts, ensuring data validity and meaningful analysis.

```{r}
#| echo: false
#| eval: true
#| label: tbl-joyce-count
#| tbl-cap: Sample Table of Word Count after Tokenization (James Joyce)
#| warning: false
#| message: false

portrait_words |>
  rename("Word" = word) |>
  head(5) |>
  kable(
    col.names = c("Word", "Count"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position"), 
                bootstrap_options = "striped", 
                full_width = FALSE)


```

Then, to quantify the number of times each word appears in each text, we used `count()` (@tbl-joyce-count). The result manifests into @fig-count, which visualizes the top 20 words with the highest word count in each SOC author's texts. 

\newpage
```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-count
#| layout-ncol: 2
#| fig-cap: "Comparative Analysis of Top 20 Word Count from Famous SOC Authors"
#| fig-subcap: ["James Joyce", "Virginia Woolf", "Marcel Proust", "T.S. Eliot", "Katherine Mansfield"]

portrait_words |> head(20) |>
ggplot(aes(x = n, y = reorder(word, n))) +
  geom_bar(stat = "identity", fill = "steelblue4") +
  geom_text(aes(label = n), hjust = -0.3, vjust = 0.5, color = "grey40", size = 3) +
  labs(x = "Count", y = "Word")

dalloway_words |> head(20) |>
ggplot(aes(x = n, y = reorder(word, n))) +
  geom_bar(stat = "identity", fill = "steelblue4") +
  geom_text(aes(label = n), hjust = -0.3, vjust = 0.5, color = "grey40", size = 3) +
  labs(x = "Count", y = "Word")

swann_words |> head(20) |>
ggplot(aes(x = n, y = reorder(word, n))) +
  geom_bar(stat = "identity", fill = "steelblue4") +
  geom_text(aes(label = n), hjust = -0.3, vjust = 0.5, color = "grey40", size = 3) +
  labs(x = "Count", y = "Word")

prufrock_words |> head(20) |>
ggplot(aes(x = n, y = reorder(word, n))) +
  geom_bar(stat = "identity", fill = "steelblue4") +
  geom_text(aes(label = n), hjust = -0.3, vjust = 0.5, color = "grey40", size = 3) +
  labs(x = "Count", y = "Word")

bliss_words |> head(20) |>
ggplot(aes(x = n, y = reorder(word, n))) +
  geom_bar(stat = "identity", fill = "steelblue4") +
  geom_text(aes(label = n), hjust = -0.3, vjust = 0.5, color = "grey40", size = 3) +
  labs(x = "Count", y = "Word") 


```

### Comparative Word Frequency

```{r}
#| echo: false
#| eval: true
#| label: tbl-frequency
#| tbl-cap: "Sample Table of Word Frequency in Stream of Consciousness Texts"
#| warning: false

frequency <- bind_rows(mutate(portrait_words, author = "James Joyce"),
                       mutate(swann_words, author = "Marcel Proust"),
                       mutate(dalloway_words, author = "Virginia Woolf"),
                       mutate(bliss_words, author = "Katherine Mansfield"),
                       mutate(prufrock_words, author = "T.S. Eliot")) |>
  mutate(word = str_extract(word, "[a-z']+")) |>
  count(author, word) |>
  group_by(author) |>
  mutate(proportion = n / sum(n)) |>
  select(-n) |>
  pivot_wider(names_from = author, values_from = proportion) |>
  filter(if_all(everything(), ~is.na(.) | !is.na(.)))

#reshape the frequency datasets and add sentiment values
bing_lexicon <- get_sentiments("bing") %>%
  rename(sentiment_binary = sentiment)

frequency_long <- pivot_longer(frequency, 
                               cols = c("James Joyce", "Marcel Proust", "Virginia Woolf", "Katherine Mansfield", "T.S. Eliot"), 
                               names_to = "author", values_to = "frequency") |>
  inner_join(bing_lexicon) |>
  inner_join(get_sentiments("afinn")) |>
  inner_join(get_sentiments("nrc")) 

frequency_long |> 
  rename("Word" = word) |>
  head(5) |>
  kable(
    col.names = c("Word", "Author", "Frequency Percent", "Binary Sentiment", "Value", "Sentiment"),
    booktabs = TRUE
  ) |>  kable_styling(latex_options = c("striped", "hold_position"), bootstrap_options = "striped", full_width = FALSE)
```

To accurately compare word count among SOC authors, from @tbl-frequency, we converted each word count from each author into a percentage. This is done by using `mutate` to calculate the word frequency of each word relative to the total word count of each author (`n/sum(n)`). Due to the different number of words present in each author's literary works, this method accounts for the inconsistencies of between each author's word count. The variables within @tbl-frequency are:

- **Word:** This variable is the word sourced from SOC literary texts.
- **Author:** This variable accounts for the author whose books contain the word in question.
- **Frequency:** This variable is the word count percentage of the word in question against each author's total word count.
- **Binary Sentiment (Bing):** This variable, as explained, comes from the Bing sentiment index, enabling us to analyze how every word is usually perceived emotionally, whether negatively or positively.
- **Value of Sentiment (AFINN):** This variable, as explained, comes from the AFINN sentiment index, enabling us to analyze how every word is usually perceived emotionally, on a scale between -5 and 5.
- **Sentiment (NRC):** This variable, as explained, comes from the NRC sentiment index, enabling us to analyze how every word is usually perceived emotionally, whether it's associated with anger, anticipation, disgust, fear, joy, negative, positive, sadness, surprise or trust.

\newpage
```{r}
#| echo: false
#| eval: true
#| label: tbl-boxplot 
#| tbl-cap: "Overall Boxplot Summary Statistics of all Word Frequency Percentages (AFINN Index)"
#| warning: false

# Calculate summary statistics
frequency_long |>
  group_by(frequency) %>%
  summarise(
    min = min(value),
    q1 = quantile(value, probs = 0.25),
    median = median(value),
    mean = mean(value),
    q3 = quantile(value, probs = 0.75),
    max = max(value),
    sd = sd(value)
  ) |>
    head(8) |>
  kable(
    col.names = c("Frequency", "Min", "Q1", "Median", "Mean", "Q3", "Max", "SD"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position"), 
                bootstrap_options = "striped", 
                full_width = FALSE)

```

@tbl-boxplot captures the text data garnered and their emotional connotations using the AFINN lexicon. Overseeing the entire dataset, @tbl-boxplot demonstrates that, for all distinct word frequency, the median sentiment value is a negative -2 on the scale between -5 and 5. More specifically, words that appear most frequently, or words with the frequency of 0.0008511%, have the most negative connotation of a -2.33 mean on the scale between -5 and 5 in the AFINN sentiment index. This summary statistic further shows how SOC literature mostly associates with words that carry  negative or even extreme connotations often associated with mental health themes, and topics such as depression, disassociation or schizophrenia [@pathology], a central argument that we will further discuss in [Results].

## Data Limitations

### Potential Measurement Errors

The actual raw text data sourced from Project Gutenberg may be susceptible to measurement errors due to various factors, such as selection bias towards older, Western and canonical texts, social desirability bias (which edits out certain political elements), memory lapses, misinterpretations of literary texts by voluntary proofreaders. While the archive has strict guidelines to minimize these errors, they cannot be entirely eliminated.

### Uneven Text Length 

We chose literary texts based on their global reception and status within the stream-of-consciousness genre. This decision didn't consider certain practical constraints, such as ensuring similar text lengths across all works by each author. While this approach enables us to thoroughly explore word frequency analysis, sentiment value, and word networks within the SOC genre, it also has a downside: privileging the frequencies of certain words from specific authors more than others due to the longer text length of those authors. This could critically affect the integrity of the data analysis.

### Biased Author Selection

Furthermore, SOC literature is expansive, spanning a wide range of themes, styles, and narrative techniques. By exclusively representing the genre through a select group of canonical Western authors, we risk constraining the genre's diversity. By oversimplifying the complexity of the literary genre, we also affect the integrity of the datasets and its correlation to mental health themes.

# Results

Upon assessing our generated datasets from Project Gutenberg, we further extrapolate on them here by combining word count with the AFINN, Bing and NRC index to conduct relevant word frequency and sentiment analysis. The later sections of Results also compound on these findings to conduct a comparative analysis between gendered SOC authors, attempting to garner relevant insights in mental health themes in different demographics of the SOC genre.  

## The Dominant Vocabulary of SOC Literature, A Word Frequency Analysis

In terms of word frequency, most words depicted in the nine selected SOC texts are abstract nouns with temporal or philosophical tendencies and negative connotations.

@fig-count demonstrates that beside personal names, words with the highest counts are mostly abstract nouns that revolve around the nature of time, and life. For instance, these words are, \textit{god} (appearing 194 times in Joyce's), \textit{time} (appearing in 4 authors' texts, 121 times for Joyce's, 77 times for Woolf's, 421 times for Proust's, 23 times for Eliot), \textit{mind} (108 times in Joyce's and 196 times in Proust's), \textit{life} (appearing 266 times in Proust's and 131 times in Joyce's), etc. This further exemplifies the sense of disassociation, temporality and non-linearity commonly associated to stream-of-consciousness literature and more broadly with mental health themes [@flow] [@pathology] [@resampling].

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-sentiment-frequency
#| layout-ncol: 2
#| fig-cap: "Boxplots of SOC Literature's Sentiment Scores by Word Frequency (Bing & NRC)"
#| fig-subcap: ["Bing lexicon", "NRC lexicon"]


# Reshape data for plotting
bing_lexicon <- get_sentiments("bing") %>%
  rename(sentiment_binary = sentiment)

frequency_long <- pivot_longer(frequency, 
                               cols = c("James Joyce", "Marcel Proust", "Virginia Woolf", "Katherine Mansfield", "T.S. Eliot"), 
                               names_to = "author", values_to = "frequency") |>
  inner_join(bing_lexicon) |>
  inner_join(get_sentiments("afinn")) |>
  inner_join(get_sentiments("nrc")) 

frequency_long <- na.omit(frequency_long) 

# Create boxplots
ggplot(frequency_long, aes(x = frequency, y = value, fill = sentiment_binary)) +
  geom_boxplot() +
  labs(
       x = "Word Frequency Percentage",
       y = "Sentiment Value (AFINN)",
       fill = "Sentiment") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_manual(values = c("lightblue", "darkblue"))


ggplot(frequency_long, aes(x = frequency, y = value, fill = sentiment)) +
  geom_boxplot() +
  labs(
       x = "Word Frequency Percentage",
       y = "Sentiment Value (AFINN)",
       fill = "Sentiment") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_manual(values = c(
    "negative" = "darkblue", "sadness" = "steelblue4", "anger" = "royalblue4",
    "disgust" = "cadetblue", "fear" = "blue4", "joy" = "skyblue",
    "trust" = "lightblue", "anticipation" = "deepskyblue", "positive" = "dodgerblue",
    "surprise" = "lightsteelblue"
  ))


```

Additionally, within @fig-sentiment-frequency, for the NRC index, between all authors, the words with lower frequency-those ranging from 0.0000819% to 0004255%-are largely words that carry a mixture of emotional connotations such as, joy, surprise, positive, disgust and anticipation. However, words with high frequency-ranging from 0,0004255% to 0.0008511%-mostly contain negative connotations like fear and negative. They also have a negative -1.875 median on a scale between -5 to 5 in the AFINN index. Similarly, for the Bing index, words with higher frequency-those ranging from 0,0004255% to 0.0008511%-largely carry negative connotations. They also have, approximately, a -1.875 median on a scale between -5 to 5 in the AFINN index. This further emphasizes how SOC literature mostly contains negativity-inclined vocabulary and linguistic patterns.

To further explore the contextual relationship between each word, @fig-word-networks creates word networks of all nine SOC texts. These networks capture how often each word frequents in these SOC texts and how closely each correlates with one another, whether as single words (unigrams) or pairs of words (bigrams). When combined all SOC texts, temporal nouns like \textit{time, day, life, moment, night} appear the most, at, respectively, 870, 597, 567, 502 and 376 times ([Appendix]'s @tbl-count). This further correlates to the non-linear nature of SOC literature and their exploration of cognitive incoherence. In terms of correlation, ignoring personal names like \textit{swann, odette or mme}, bigrams with a correlation of 1 include word pairs like \textit{dark, love}; \textit{day, heart}; \textit{moment, life}; \textit{mind, life}; \textit{moment, mind}, among others ([Appendix]'s @tbl-correlation). Observable from  @fig-word-networks, with a correlation and a word count of at least 0.8 and 400, \textit{people, moment, life} and \textit{mind} are the most predominant word combinations throughout all 9 SOC texts.

This word frequency and correlation analysis then has enabled us to grasp the thematic framework of SOC literature, where most correlated and frequently present words are those with philosophical undertones, a sense of temporality and tinge of mental incoherence like \textit{dark, love}. While not entirely direct, this has somewhat portrayed SOC literature as being intricately linked to cognitive dissonance or the mind, and especially mental health issues in which SOC authors have portrayed through their characters [@flow] [@pathology] [@resampling].

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false

## Code sourced from https://www.youtube.com/watch?v=ae_XVhjHd_o

## Create word network, first, n >=250
generate_word_graph <- function(combined_text,
                                minimum_n = 100,
                                minimum_correlation = 0.2) {

combined_text_count <- combined_text |>
  count(word, sort = TRUE) |>
  filter(n >= 250) 

combined_correlations <- combined_text |>
  semi_join(combined_text_count, by = "word") |>
  pairwise_cor(item = word, feature = book) |>
  filter(correlation >= 0.2)

graph_from_data_frame(d = combined_correlations, #create graphs of networks of words
                      vertices = combined_text_count |>
                      semi_join(combined_correlations, by = c("word" = "item1"))) |>
  ggraph(layout = "fr") +
  geom_edge_link(aes(alpha = correlation), alpha = 0.05) +
  geom_node_point() +
  geom_node_text(aes(color = n, label = name), repel = TRUE)
}

## Create word network, second, n >=300
generate_word_graph_second <- function(combined_text,
                                minimum_n = 100,
                                minimum_correlation = 0.2) {

combined_text_count <- combined_text |>
  count(word, sort = TRUE) |>
  filter(n >= 300) 

combined_correlations <- combined_text |>
  semi_join(combined_text_count, by = "word") |>
  pairwise_cor(item = word, feature = book) |>
  filter(correlation >= 0.4)

graph_from_data_frame(d = combined_correlations, #create graphs of networks of words
                      vertices = combined_text_count |>
                      semi_join(combined_correlations, by = c("word" = "item1"))) |>
  ggraph(layout = "fr") +
  geom_edge_link(aes(alpha = correlation), alpha = 0.05) +
  geom_node_point() +
  geom_node_text(aes(color = n, label = name), repel = TRUE)
}


## Create word network, third, n >=350
generate_word_graph_third <- function(combined_text,
                                minimum_n = 100,
                                minimum_correlation = 0.2) {

combined_text_count <- combined_text |>
  count(word, sort = TRUE) |>
  filter(n >= 350) 

combined_correlations <- combined_text |>
  semi_join(combined_text_count, by = "word") |>
  pairwise_cor(item = word, feature = book) |>
  filter(correlation >= 0.6)

graph_from_data_frame(d = combined_correlations, #create graphs of networks of words
                      vertices = combined_text_count |>
                      semi_join(combined_correlations, by = c("word" = "item1"))) |>
  ggraph(layout = "fr") +
  geom_edge_link(aes(alpha = correlation), alpha = 0.05) +
  geom_node_point() +
  geom_node_text(aes(color = n, label = name), repel = TRUE)
}

## Create word network, fourth, n>= 400
generate_word_graph_final <- function(combined_text,
                                minimum_n = 100,
                                minimum_correlation = 0.2) {

combined_text_count <- combined_text |>
  count(word, sort = TRUE) |>
  filter(n >= 400) 

combined_correlations <- combined_text |>
  semi_join(combined_text_count, by = "word") |>
  pairwise_cor(item = word, feature = book) |>
  filter(correlation >= 0.8)

graph_from_data_frame(d = combined_correlations, #create graphs of networks of words
                      vertices = combined_text_count |>
                      semi_join(combined_correlations, by = c("word" = "item1"))) |>
  ggraph(layout = "fr") +
  geom_edge_link(aes(alpha = correlation), alpha = 0.05) +
  geom_node_point() +
  geom_node_text(aes(color = n, label = name), repel = TRUE)
}

```


```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-word-networks
#| layout-ncol: 2
#| fig-cap: "Word Networks Measured by Frequency and Correlation when Combining All Stream of Consciousness Texts"
#| fig-subcap: ["250 Frequency, 0.2 Correlation", "300 Frequency, 0.4 Correlation", "350 Frequency, 0.6 Correlation", "400 Frequency, 0.8 Correlation"] 

# Generate word networks based on previously created functions
combined_text|>
  generate_word_graph(minimum_n = 250, minimum_correlation = 0.2)

combined_text|>
  generate_word_graph_second(minimum_n = 300, minimum_correlation = 0.4)


combined_text|>
  generate_word_graph_third(minimum_n = 350, minimum_correlation = 0.6)


combined_text|>
  generate_word_graph_final(minimum_n = 400, minimum_correlation = 0.8)
```
\newpage
## Sentiment Analysis

To further understand the emotional landscape and mental health themes related to SOC literature, all nine SOC texts are combined to conduct an overall sentiment analysis [@sentiment].

For the Bing index, @fig-sentiment-category shows that, SOC authors' literary works are predominantly negative. All authors, except for Mansfield, demonstrates this. 68% of Joyce's works are negative compared to his 32% positive, similar to Eliot's, which is also the highest statistic out of all five authors. Woolf comes second with 60% words carrying negative meanings, while 40% are negative. Proust comes fourth with 57% negative and 43% positive. While Mansfield has words with positive connotations, at 51%, this isn't much different from her 49% negative words.

For the NRC index, @fig-sentiment-category further details the emotional nuances of SOC literature. The dominant emotional connotation in SOC literature's vocabulary is negative, standing at 16% to 22%. While the second highest percentage range belongs to words with positive connotation, ranging from 11% to 17%. However, most of the other bars in the graph are occupied by words with negative-leaning emotions, such as sadness, fear, and anger. Sadness-related words, in particular, range the third highest, from 11% to 15%.


```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-sentiment-category
#| layout-ncol: 2
#| fig-cap: "Categorical Sentiment Analysis of All SOC Texts by Authors"
#| fig-subcap: ["Bing lexicon", "NRC lexicon"]

bing_lexicon <- get_sentiments("bing") |>
  rename(sentiment_binary = sentiment)

sentiment_combined <- combined_text |>
  inner_join(bing_lexicon) |>
  inner_join(get_sentiments("afinn")) |>
  inner_join(get_sentiments("nrc"))

sentiment_category_binary <- sentiment_combined |>
  group_by(author, sentiment_binary) |>
  count() |>
  group_by(author) |>
  mutate(percentage = round(n / sum(n) * 100))  

# Plot sentiment values
ggplot(sentiment_category_binary, aes(x = author, fill = sentiment_binary, y = percentage)) +
  geom_bar(stat = "identity") +
    geom_text(aes(label = percentage),position = position_stack(vjust = 0.5), color = "white", size = 3) +
  labs(
       x = "Author", y = "Percentage", fill = "Sentiment") +
  scale_fill_manual(values = c("positive" = "lightblue", "negative" = "darkblue")) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),  legend.key.size = unit(0.5, "cm"))

sentiment_category <- sentiment_combined |>
  group_by(author, sentiment) |>
  count() |>
  group_by(author) |>
  mutate(percentage = round(n / sum(n) * 100))  |>
  group_by(author) |>
  arrange(desc(percentage))

# Plot sentiment values
ggplot(sentiment_category, aes(x = author, fill = sentiment, y = percentage)) +
  geom_bar(stat = "identity") +
   geom_text(aes(label = percentage),  position = position_stack(vjust = 0.5), color = "white", size = 3) +
  labs(
       x = "Author", y = "Percentage", fill = "Sentiment") +
   scale_fill_manual(values = c(
    "negative" = "darkblue", "sadness" = "steelblue4", "anger" = "royalblue4",
    "disgust" = "cadetblue", "fear" = "blue4", "joy" = "skyblue",
    "trust" = "lightblue", "anticipation" = "deepskyblue", "positive" = "dodgerblue",
    "surprise" = "lightsteelblue"
  )) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
       legend.key.size = unit(0.5, "cm"))


```

The AFINN index in @fig-sentiment-number portrays a similar trend. On a scale of -5 to 5, SOC literature from these five authors mostly carry a negative sentiment, observable in the significant difference in height between the negative trendlines and the positive trendlines. Eliot's works are the most negative with 37% of words being -2 on the emotional scale between -5 and 5. Respectively, Woolf's, Proust's and Joyce's tail beind at 33%, 32% and 31%, averaging out to be -2.2 on the emotional scale between -5 and 5. While a great portion of Mansfield's works are positive, 24% of her words-her largest percentage-are negative, earning a -2.2 negative score between -5 and 5 in the AFINN index.

This further suggests that the SOC literary landscape mainly has negative, disgust, fear and sadness-leaning vocabulary. These trends reflect the incoherent mental spaces, depressive perceptions, and existential angst inherent to SOC literature. These are the central themes often conveyed by SOC authors through their exploration of the unconscious mind and repressed emotions, reflecting the societal concerns of the late 19th to mid-20th century West [@pathology] [@resampling].

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-sentiment-number
#| fig-cap: "Numerical Sentiment Analysis of All SOC Texts by Authors (AFINN lexicon)"

sentiment_value <- sentiment_combined |>
  inner_join(get_sentiments("bing")) |>
  group_by(author, value, sentiment) |>
  count() |>
  group_by(author) |>
  mutate(percentage = round(n / sum(n) * 100))

ggplot(sentiment_value, aes(x = value, y = percentage, fill = sentiment, color = sentiment)) +
  geom_line() +
    geom_text(aes(label = percentage),position = position_stack(vjust = 0.5), color = "black", size = 2) +
  facet_wrap(~ author, scales = "free") +
  labs(
       x = "Sentiment Value", y = "Percentage", fill = "Sentiment") +
  scale_color_manual(values = c("positive" = "lightblue", "negative" = "darkblue")) + # Adjust line colors
  theme_minimal()
```


## Gendered Mental Landscape of Stream of Consciousness Authorw

To further expand on the analysis, we have also used our word frequency data from @tbl-frequency to conduct a gendered analysis between different SOC authors. @fig-word-gender attempts to assess the word frequency between female and male SOC authors. Dots closer together around the diagonal line tend to appear with similar frequency for all authors involved. Words further up and to the left are more typical for those on the y-axis, and closer to the lower right corner: those on the x-axis.

@fig-word-gender shows that for female SOC authors, while having smaller word frequency due to the lighter blue, still have their words perfectly revolved the regression line, showing that both Woolf and Mansfield are comparatively close in terms of linguistic patterns. Woolf and Mansfield mostly have a word frequency of 0.0001421262% and 0.0001277302% for each word present in their texts, with some of their shared vocabulary being \textit{anxious}, \textit{angry}, \textit{anguish}, \textit{dreadful}, among others.

As for male authors, @fig-word-gender shows that, while their words have a higher appearance frequency, they have less correlation as the regression line isn't centered, showing the dissimilar vocabulary used between male authors. Mostly, Eliot, Proust and Joyce have a word frequency of 0.0004255319%, 0.0000819% and 0.000112% for each word present in their texts, with some of their shared vocabulary being \textit{agony}, \textit{cry}, \textit{die}, \textit{chaos}, among others. Proust and Joyce, two novelists, seem to have more similarities compared to Eliot, who is a poet.

Through this gendered analysis and @fig-sentiment-category, we can see discrepancies between male and female SOC authors, especially in terms of shared linguistic patterns and mental health themes. @gender poses that in terms of genders, writers-or here SOC writers-tend to write about affects or mental health themes differently. While females tend to have reservations over their emotions or are similarly positive, males tend to be more open and individualistic due to less social constraints at the time, which will be further discussed in [Discussion] below.


```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-word-gender
#| layout-ncol: 2
#| fig-cap: "Comparative Analysis of Word Frequency in Female and Male SOC Authors"
#| fig-subcap: ["Female Authors", "Male Authors"]

bing_lexicon <- get_sentiments("bing") %>%
  rename(sentiment_binary = sentiment)

# Calculate the word frequency over all unique words and bind all frequency rate of authors together to conduct a comparative comparison
# Code referenced from https://medium.com/the-data-nudge/nlp-basics-exploring-word-frequency-with-the-tidytext-r-package-ac35a6d805f4

  
frequency_female <- bind_rows(mutate(dalloway_words, author = "Virginia Woolf"),
                              mutate(bliss_words, author = "Katherine Mansfield")) |>
  mutate(word = str_extract(word, "[a-z']+")) |>
  count(author, word) |>
  group_by(author) |>
  mutate(proportion = n / sum(n)) |>
  select(-n) |>
  pivot_wider(names_from = author, values_from = proportion) |>
  pivot_longer(`Virginia Woolf`,
               names_to = "author", values_to = "proportion") |>
    inner_join(bing_lexicon) |>
  inner_join(get_sentiments("afinn")) |>
  inner_join(get_sentiments("nrc")) 

ggplot(frequency_female, aes(x = proportion, y = `Katherine Mansfield`, fill = value, color = abs(`Katherine Mansfield` - proportion))) +
  geom_abline(color = "gray50", lty = 2) +
  geom_jitter(alpha = 0.1, size = 1, width = 0.5, height = 0.5) +  
geom_text(aes(label = word), check_overlap = TRUE, vjust = 1.5) +  scale_x_log10(labels = scales::percent_format()) +
  scale_y_log10(labels = scales::percent_format()) +
  scale_color_gradient(limits = c(0, 0.001), 
                       low = "steelblue", high = "darkblue") +
  facet_wrap(~author, ncol = 1) +
  theme(legend.position="none") +
  labs(y = "Katherine Mansfield", x = NULL)

frequency_male <- bind_rows(
                       mutate(swann_words, author = "Marcel Proust"),
                       mutate(prufrock_words, author = "T.S. Eliot"),
                       mutate(portrait_words, author = "James Joyce")) |>
  mutate(word = str_extract(word, "[a-z']+")) |>
  count(author, word) |>
  group_by(author) |>
  mutate(proportion = n / sum(n)) |>
  select(-n) |>
  pivot_wider(names_from = author, values_from = proportion) |>
  pivot_longer(`Marcel Proust`:`James Joyce`,
               names_to = "author", values_to = "proportion") |>
    inner_join(bing_lexicon) |>
  inner_join(get_sentiments("afinn")) |>
  inner_join(get_sentiments("nrc")) 

ggplot(frequency_male, aes(x = proportion, y = `T.S. Eliot`, color = abs(`T.S. Eliot` - proportion))) +
  geom_abline(color = "gray50", lty = 2) +
  geom_jitter(alpha = 0.1, size = 1.5, width = 0.8, height = 0.8) +  
  geom_text(aes(label = word), check_overlap = TRUE, vjust = 1.5) +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  scale_color_gradient(limits = c(0, 0.001), 
                       low = "steelblue", high = "darkblue") +
  facet_wrap(~author, ncol = 1) +
  theme(legend.position="none") +
  labs(y = "T.S. Eliot", x = NULL)


```

# Discussion

## Mental Health Vocabulary: Patterns and Trends 

The findings in this paper reveals a correlative relationship between SOC literature and mental health-inclined vocabulary and linguistic patterns. In terms of frequency, a dominant portion-over 60% of words in the NRC index-from select SOC texts have negative and sadness-leaning words ([@fig-sentiment-frequency]) ([@fig-sentiment-category]) ([@fig-sentiment-number]). Most repeated words are abstract, temporal nouns like \textit{time}, \textit{mind} or \textit{life}, which are aligned with SOC literature's exploration of mind wandering, non-linearity and unconscious cognition ([@fig-word-networks]). 

As scholars Bernini and Fernyhough mentioned, the "mysterious nature of the conscious" is "a simultaneously fragmented and unified mental realm" [@resampling], this analysis has also reflected that sentiment in SOC literature. Most of the texts express the desire to textually replicate the inner workings of the human mind, attempting to capture the complexity of thought processes and emotions. With these inner-workings revealed to be mostly negative and existential, SOC authors have explored their identity and worldview in an authentic manner, deeply portraying then-taboo topics such as existential angst, anxiety and cognitive dissonance.

## Insights into Socio-Political Landscape of the West's Modernist Era 

Through the analysis, we can see the SOC texts' linguistic patterns reflect the socio-political landscape of Western society. The SOC genre originated from modernist literature, whose writers often rebelled against linear and traditional narrative techniques of the 19th century [@resampling]. According to scholar Nyongesa, "marginalization occasioned by the dominant group result in neurotic conditions in members of the minority group" [@pathology], which rings true to the scenario at hand about SOC literature and its relationship to its birthplace: late 19th to mid-20th century Western society. 

There are several reasons rooted in the West's modernist era that resulted in the  growth and popularity of the SOC genre. This period's rapid industrialization and urbanization reshaped the traditional institutions of Western society, leading to fragmentation and dislocation, which SOC authors had attempted to capture in their own works [@flow]. Advancing transportation, photographic media and mass communication affected the West's sense of time and space, which in turn affected how people understood reality. This is a central pillar of SOC literature: distorted reality, atemporality and an unconscious perception of the world.

This time period also saw the West's crisis of faith in traditional religious beliefs. With the emergence of Darwin's theory of evolution, Freudian psychology, and existential philosophy came different notions of human existence, morality, and meaning [@resampling]. The heightened search for individuality had SOC authors embraced themes such as alienation, identity and mental health in an increasing fragmented world. The devastation from World War I and the interwar period also further intensified this crisis. Post-war collapse of nations created new ideologies like communism and fascism. This in turn created an atmosphere of disillusionment and uncertainty that SOC literature attempted to answer with its anxious and disassociative writing style.

## Gender Differences within Stream of Consciousness Genre and Mental Health

Further, our gendered analysis of SOC literature in @fig-word-gender reveals differences in linguistic patterns between male and female authors during this time period, particularly in their portrayal of affects and mental health themes. Female writers tend to exhibit more reserved emotions or positivity, while male writers display greater emotional range and individualism, influenced by restrictions of female expressions at their time. 

Research findings indicate that, on average, female writers use positive words more frequently than male writers, reflecting societal norms attributing positive emotions to females [@gender]. The similarity in vocabulary among SOC female writers like Woolf and Mansfield may stem from shared-or restricted-literary influences, higher cultural and social expectations, common personal experiences, and considerations of reader norms during the West's late 19th to mid-20th century. These factors contribute to a nuanced understanding of gendered linguistic patterns, which has been shown to be more forgiving towards male authors than female authors in the SOC genre.

## Weaknesses 

### Lack of Thorough Word Cleaning

With the large amount of different literary texts need processing, it's hard to truly conduct thorough word processing. Certain texts, while can have their frequencies accounted for, can't have sentiment analysis due to their factual nature. These textual elements might include things like chapter titles, texts from a language other than English, Roman numbers and personal names, which can strongly skew and affect the data integrity. As observed in @fig-count, \textit{Swann}, \textit{Stephen} or \textit{Jacob} are the most repeated words in Proust's, Joyce's and Woolf's, proving this data limitation.

### Decontextualized Words and Limiting Literature Selection

Throughout our analysis, words are singled out and analyzed without contexts which could have affected their intended meanings, especially in such a complex genre such as SOC. For instance, the commonly repeated words \textit{time}, \textit{mind} or \textit{life} in our selected SOC texts might mean something entirely different when combined with other words. Paradoxically, these words may be insignificant to the SOC texts in question themselves as they're only small units of already expansive literary works that often have complex themes. Therefore, word frequency analysis might have not been nuanced when analyzing the contexts behind mental health themes and their relationship to SOC literature. In addition, not all SOC texts in the archive are available to be transcribed into datasets due to licensing issues, further limiting our analysis.

### Reliance on A Small Number of Sentiment Indices

To ensure a thorough sentiment analysis of SOC texts, this paper has leveraged three widely used sentiment indices, namely Bing, NRC and AFINN. However, a sole dependence on the emotional metrics of these three indices might not be nuanced enough. This is because to categorize words into a specific emotion is an arduous and complex tasks, as emotions aren't easily quantifiable and words are mainly context-based. In addition, some of the indices used might not ensure valid data analysis. For instance, @tbl-frequency shows that, using the NRC index, the word \textit{accomplished} can mean two different emotions: joy and positive. This flexible categorization can very much skew the results of the sentiment analysis, bringing one emotion more to the forefront than others.

## Moving Forward and Next Steps

Moving forward, to gain a deeper understanding of the relationship between SOC literature and mental health themes, more diverse and better natural language processing (NLP) indices, methods and processes must be used to conduct a more accurate analysis.

As mentioned, relying on three sentiment indices are not enough to accurately capture the emotional sentiments of the words used in SOC literature due to how context-based words are. More relevant indices then should be incorporated into the analysis.

In addition, due to the abstract nature of SOC texts, using advanced NLP models is more effective for analysis rather than focusing solely on small linguistic units such as words or word frequency. Topic modeling, for example, is a technique in NLP used to uncover abstract topics within texts like SOC literature. Leveraging algorithms like Latent Dirichlet Allocation (LDA) and Non-negative Matrix Factorization (NMF), topic modeling helps identify patterns of co-occurring words within SOC literature, grouping them into clusters that represent coherent themes or topics that can be relevant to our mental health analysis of the SOC genre.

Lastly, due to the qualitative nature of SOC literature, using a more mixed methods approach-combining both quantitative and qualitative data analysis-will offer a more comprehensive understanding of the broader mental health trends and the literary genre itself.

# Conclusion

This study analyzes stream of consciousness (SOC) literature's linguistic patterns, revealing its  portrayal of mental health themes. Through our analysis of works by Joyce, Woolf, Proust, Mansfield, and Eliot, we uncover that SOC literature is largely negative or sadness-inclined with a philosophical and temporal undertones due to its exploration of unconscious cognition. In addition, expression and sentiment-wise, female authors' writing is more restricted compared to male authors, revealing gendered differences in SOC literature. While our quantitative analysis provides insights into the genre's relationship with mental health themes, it's important to recognize its limitations in capturing the richness of SOC language. Therefore, moving forward, using more advanced NLP methods will better benefit our exploration of the relationship between SOC literature and mental health themes. We hypothesize that this can provide deeper insights into the genre, and the reasons for its growth in Western society during late 19th to mid-20th century.

\newpage

# Appendix

## All Books from Project Gutenberg Archive

```{r}
#| echo: false
#| eval: true
#| label: tbl-all
#| tbl-cap: "A Sample of Project Gutenberg Archive's Book Database"
#| warning: false

all_books <- all_books[5:10, ] 

all_books |>
  select(-gutenberg_author_id, -rights, -language, -gutenberg_bookshelf) |>
  rename("Book ID" = gutenberg_id,
         "Title" = title,
         "Author" = author,
         "Text Included" = has_text) |>
  tail(5) |>
  kable(
    col.names = c("Book ID", "Title", "Author", "Text Included"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position", "scale_down"), 
                bootstrap_options = "striped") 

```

## Combined Bibliographies from Five Authors

```{r}
#| echo: false
#| eval: true
#| label: tbl-combined
#| tbl-cap: "Sample Combined Bibliographies of Stream of Consciousness Texts from Five Authors"
#| warning: false

combined_books |>
   select(-gutenberg_author_id, -rights, -language, -gutenberg_bookshelf) |>
  rename("Book ID" = gutenberg_id,
         "Title" = title,
         "Author" = author,
         "Text Included" = has_text) |>
  head(5) |>
  kable(
    col.names = c("Book ID", "Title", "Author", "Text Included"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position"), 
                bootstrap_options = "striped", 
                full_width = FALSE)

```

## Combined Statistcs

### Combined Count

```{r}
#| echo: false
#| eval: true
#| label: tbl-count
#| tbl-cap: "Sample Combined Count of Words from All Nine Stream of Consciousness Texts"
#| warning: false

combined_text_count <- combined_text |>
  count(word, sort = TRUE) |>
  filter(n >= 400) 

combined_text_count |>
  rename("Word" = word,
         "Count" = n) |>
  head(5) |>
  kable(
    col.names = c("Word", "Count"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position", "scale_down"), 
                bootstrap_options = "striped", 
                full_width = FALSE)

```

### Combined Correlation

```{r}
#| echo: false
#| eval: true
#| label: tbl-correlation
#| tbl-cap: "Sample Combined Bibliographies of 9 Selected Stream of Consciousness Texts"
#| warning: false

combined_correlations <- combined_text |>
  semi_join(combined_text_count, by = "word") |>
  pairwise_cor(item = word, feature = book) |>
  filter(correlation >= 0.8)


combined_correlations |>
  rename("Word 1" = item1,
         "Word 2" = item2,
         "Correlation" = correlation) |>
  head(5) |>
  kable(
    col.names = c("Word 1", "Word 2", "Correlation"),
    booktabs = TRUE
  ) |>
  kable_styling(latex_options = c("striped", "hold_position"), 
                bootstrap_options = "striped", 
                full_width = FALSE)

```


\newpage

# References

